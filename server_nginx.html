---
layout: default
title: enable cross-origin resource sharing
---

<div class="container">
  <section>
    <h1>CORS on Nginx</h1>
    
    <p>The following Nginx configuration enables CORS, with support
      for preflight requests, using a regular expression to define a
      whitelist of allowed origins, and various default values that
      may be needed to workaround incorrect browser
      implementations.</p>

    <pre class="code">
map $http_origin $cors_header {
    default "";
    "~^https?://[^/]+\.example\.com(:[0-9]+)?$" "$http_origin";
}

server {
    ...
    location / {
        add_header Access-Control-Allow-Origin $cors_header;
        try_files $uri $uri/ /index.php;
    }
    ...
 }
    </pre>
    Source: <a href="http://serverfault.com/questions/674900/nginx-if-statement-inside-location-returns-404">http://serverfault.com/questions/674900/nginx-if-statement-inside-location-returns-404</a>
  </section>
</div>
